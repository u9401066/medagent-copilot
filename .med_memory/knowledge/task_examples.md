# Task Examples (Generic Patterns)

⚠️ **注意**: 這些是通用模式範例，不是真實測試題目。
Agent 應該根據任務指令靈活應用這些模式。

---

## 查詢類任務模式

### 模式 1: 查詢病患資料

**情境**: 需要找到病患的 MRN 或 FHIR ID

**步驟**:
1. 使用 `search_patient` 或 `get_patient_by_mrn`
2. 從回傳中提取需要的資訊
3. 格式化答案為 JSON array

**答案格式**: `["MRN"]` 或 `["Patient not found"]`

---

### 模式 2: 查詢檢驗值

**情境**: 需要查詢特定時間範圍內的檢驗結果

**步驟**:
1. 使用 `get_observations` 指定 `code` 和 `date` 參數
2. 找到最新/平均/特定的數值
3. 如果沒有資料，回傳 `[-1]`

**時間篩選格式**: `ge{ISO datetime}` 表示大於等於

**答案格式**: `[數值]` 或 `[-1]`

---

## 寫入類任務模式

### 模式 3: 記錄生命徵象

**情境**: 需要記錄血壓或其他生命徵象

**步驟**:
1. 確認病患 FHIR ID
2. 使用 `create_vital_sign` 提供 code, value, datetime
3. 確認成功後回傳 `[]`

---

### 模式 4: 開立藥物醫囑

**情境**: 根據檢驗值決定是否需要補充

**步驟**:
1. 先查詢相關檢驗值
2. **查閱 med://knowledge/clinical** 取得閾值和劑量規則
3. 判斷是否需要開單
4. 如需開單，使用 `create_medication_order`

**重要**: 劑量計算要參考知識庫，不要猜測！

---

### 模式 5: 開立轉診/檢驗

**情境**: 需要開立會診或追蹤檢驗

**步驟**:
1. 確認需要的 code system 和 code
2. 如果是轉診，準備 SBAR 格式的 note
3. 使用 `create_service_request`

**SBAR 結構**:
- Situation: 目前狀況
- Background: 相關背景
- Assessment: 評估
- Recommendation: 建議

---

## 複合類任務模式

### 模式 6: 查詢 + 條件判斷 + 開單

**情境**: 根據檢驗結果決定下一步行動

**步驟**:
1. 查詢檢驗值
2. 與知識庫的閾值比較
3. 如果異常，根據嚴重程度選擇劑量
4. 開立對應醫囑
5. 如果需要追蹤，也開立追蹤檢驗

**關鍵**: 每一步都是獨立的 tool 呼叫，保持靈活性！

---

## 答案格式總結

| 任務類型 | 答案格式 |
|---------|---------|
| 找 MRN | `["S1234567"]` |
| 計算年齡 | `[60]` |
| 查詢數值 | `[1.8]` 或 `[-1]` |
| 計算平均 | `[120]` |
| 寫入成功 | `[]` |
| 病患不存在 | `["Patient not found"]` |

---

## ⚠️ 重要提醒

1. **不要假設** - 每個任務都要實際查詢 FHIR
2. **參考知識庫** - 閾值和劑量在 `med://knowledge/clinical`
3. **保持靈活** - 這些是模式，不是固定步驟
4. **驗證結果** - 確認 POST 操作成功再回答
